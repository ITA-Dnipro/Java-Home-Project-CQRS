CreateVote:
  type: object
  required:
    - question_votes
  properties:
    question_votes:
      type: array
      items:
        $ref: '#/CreateQuestionVote'
      example:
        [
          {
            "question": { "id": 1 },
            "type": "advice",
            "answer": { "answer": "yellow" }
          },
          {
            "question": { "id": 2 },
            "type": "multiple_choice",
            "answers": [
              { "id": 1 },
              { "id": 3 }
            ]
          }
        ]

CreateQuestionVote:
  type: object
  required:
    - question
    - type
  discriminator:
    propertyName: type
    mapping:
      multiple_choice: '#/CreateMultipleChoiceQuestionVote'
      advice: '#/CreateAdviceQuestionVote'
  properties:
    type:
      $ref: 'question.yaml#/QuestionType'

CreateMultipleChoiceQuestionVote:
  allOf:
    - $ref: '#/CreateQuestionVote'
  type: object
  required:
    - answers
  properties:
    question:
      $ref: 'question.yaml#/MultipleChoiceQuestionLookup'
    answers:
      type: array
      minItems: 1
      items:
        $ref: '#/AnswerVariantLookup'
      example:
        [
          {
            "id": 1
          },
          {
            "id": 3
          }
        ]

CreateAdviceQuestionVote:
  allOf:
    - $ref: '#/CreateQuestionVote'
  type: object
  required:
    - answer
  properties:
    question:
      $ref: 'question.yaml#/AdviceQuestionLookup'
    answer:
      $ref: './answer.yaml#/CreateUpdateAnswerVariant'

AnswerVariantLookup:
  type: object
  properties:
    id:
      type: integer
      format: int64
      example: 1

ReadVote:
  allOf:
    - $ref: 'common.yaml#/BaseReadView'
  type: object
  properties:
    question_votes:
      type: array
      items:
        $ref: '#/ReadQuestionVote'
      example: { }

ReadQuestionVote:
  allOf:
    - $ref: 'common.yaml#/BaseReadView'
  type: object
  discriminator:
    propertyName: type
    mapping:
      multiple_choice: '#/ReadMultipleChoiceQuestionVote'
      advice: '#/ReadAdviceQuestionVote'
  properties:
    type:
      $ref: 'question.yaml#/QuestionType'
    question:
      $ref: 'question.yaml#/ReadQuestion'

ReadMultipleChoiceQuestionVote:
  allOf:
    - $ref: '#/ReadQuestionVote'
  type: object
  required:
    - answers
  properties:
    answers:
      type: array
      minItems: 1
      items:
        $ref: 'answer.yaml#/ReadAnswerVariant'
      example:
        - id: 1
          answer: Green
        - id: 2
          answer: Blue

ReadAdviceQuestionVote:
  allOf:
    - $ref: '#/ReadQuestionVote'
  type: object
  required:
    - answer
  properties:
    answer:
      $ref: 'answer.yaml#/ReadAnswerVariant'
